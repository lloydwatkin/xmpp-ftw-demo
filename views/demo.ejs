<% 
    body.id = "demo"
    pageTitle = "Demo System"
%>
<% include ./partials/head %>
<p>Messages are loaded from the <a href="/manual" title="XMPP-FTW manual">manual</a> and parsed into 
this page. The socket is listening on all incoming messages from the manual. Additionally, all outgoing 
messages are known by this demo script along with example payloads.</p>

<p>To use this demo start typing in a message at the bottom of the page (autocomplete in place). Once you 
have <strong>selected</strong> a message the payload box will be filled with an example message. Click 'send' to send the 
message, the DOM will be updated to reflect your messages. The string you enter must be valid JSON in order for it to be parsed.</p>

<div class="demo-storage example">
    <p><label>
    <input type="checkbox" name="useStorage" /> Use local storage
    </label>
    <span class="clear-storage" title="Clear local storage">(clear)</span>
    </p>
    <p>Store valid outgoing payloads for reuse?</p>
</div>

<p><em>Ctrl/Cmd + click</em> on the payload boxes to zoom and once again to zoom back out. You can also zoom the outgoing payload box when creating longer JSON strings.</p>

<p class="hint"><span class="bold">Hint:</span> You'll probably want to start with '<i>xmpp.login</i>'.</p>

<div class="messages-container">
    <h2>Messages</h2>

    <div id="messages"></div>

    <div class="send payload">
        <div class="message ui-widget" title="Event name">
            <input type="text" id="message" placeholder="event name (autocompletes)" />
        </div>
        <div class="data zoomable" id="data" contenteditable="true" title="Message to send"></div>
        <div class="callback" id="callback" title="Green if callback used"></div>
       <div class="send"><button id="send">Send</button></div>
    </div>
</div>

<div id="modal"><pre class="example"></pre></div>

<script type="text/javascript">
  var protocol = location.protocol
  if (protocol === 'http:') {
    alert('Note: This site is using HTTP which is not secure.\n\nPlease use https://xmpp-ftw.herokuapp.com/demo for a secure endpoint')
  }
</script>
<script type="text/javascript" src="/scripts/primus.js"></script>
<script type="text/javascript" src="/scripts/demo.js"></script>
<% include ./partials/footer %>
